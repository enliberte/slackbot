!function(e){function t(e){var t=require("./"+e+"."+o+".hot-update.js");!function(e,t){if(!g[e]||!w[e])return;for(var n in w[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(d[n]=t[n]);0==--y&&0===b&&x()}(t.id,t.modules)}var n,r=!0,o="cca5a783c73022c23560",i={},s=[],u=[];function a(e){var t=I[e];if(!t)return P;var r=function(r){return t.hot.active?(I[r]?-1===I[r].parents.indexOf(e)&&I[r].parents.push(e):(s=[e],n=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),s=[]),P(r)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return P[e]},set:function(t){P[e]=t}}};for(var i in P)Object.prototype.hasOwnProperty.call(P,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(r,i,o(i));return r.e=function(e){return"ready"===f&&p("prepare"),b++,P.e(e).then(t,(function(e){throw t(),e}));function t(){b--,"prepare"===f&&(_[e]||O(e),0===b&&0===y&&x())}},r.t=function(e,t){return 1&t&&(e=r(e)),P.t(e,-2&t)},r}function c(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:m,apply:E,status:function(e){if(!e)return f;l.push(e)},addStatusHandler:function(e){l.push(e)},removeStatusHandler:function(e){var t=l.indexOf(e);t>=0&&l.splice(t,1)},data:i[e]};return n=void 0,t}var l=[],f="idle";function p(e){f=e;for(var t=0;t<l.length;t++)l[t].call(null,e)}var h,d,v,y=0,b=0,_={},w={},g={};function S(e){return+e+""===e?+e:e}function m(e){if("idle"!==f)throw new Error("check() is only allowed in idle status");return r=e,p("check"),function(){try{var e=require("./"+o+".hot-update.json")}catch(e){return Promise.resolve()}return Promise.resolve(e)}().then((function(e){if(!e)return p("idle"),null;w={},_={},g=e.c,v=e.h,p("prepare");var t=new Promise((function(e,t){h={resolve:e,reject:t}}));d={};return O(0),"prepare"===f&&0===b&&0===y&&x(),t}))}function O(e){g[e]?(w[e]=!0,y++,t(e)):_[e]=!0}function x(){p("ready");var e=h;if(h=null,e)if(r)Promise.resolve().then((function(){return E(r)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var n in d)Object.prototype.hasOwnProperty.call(d,n)&&t.push(S(n));e.resolve(t)}}function E(t){if("ready"!==f)throw new Error("apply() is only allowed in ready status");var n,r,u,a,c;function l(e){for(var t=[e],n={},r=t.map((function(e){return{chain:[e],id:e}}));r.length>0;){var o=r.pop(),i=o.id,s=o.chain;if((a=I[i])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:i};if(a.hot._main)return{type:"unaccepted",chain:s,moduleId:i};for(var u=0;u<a.parents.length;u++){var c=a.parents[u],l=I[c];if(l){if(l.hot._declinedDependencies[i])return{type:"declined",chain:s.concat([c]),moduleId:i,parentId:c};-1===t.indexOf(c)&&(l.hot._acceptedDependencies[i]?(n[c]||(n[c]=[]),h(n[c],[i])):(delete n[c],t.push(c),r.push({chain:s.concat([c]),id:c})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&e.push(r)}}t=t||{};var y={},b=[],_={},w=function(){console.warn("[HMR] unexpected require("+O.moduleId+") to disposed module")};for(var m in d)if(Object.prototype.hasOwnProperty.call(d,m)){var O;c=S(m);var x=!1,E=!1,R=!1,D="";switch((O=d[m]?l(c):{type:"disposed",moduleId:m}).chain&&(D="\nUpdate propagation: "+O.chain.join(" -> ")),O.type){case"self-declined":t.onDeclined&&t.onDeclined(O),t.ignoreDeclined||(x=new Error("Aborted because of self decline: "+O.moduleId+D));break;case"declined":t.onDeclined&&t.onDeclined(O),t.ignoreDeclined||(x=new Error("Aborted because of declined dependency: "+O.moduleId+" in "+O.parentId+D));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(O),t.ignoreUnaccepted||(x=new Error("Aborted because "+c+" is not accepted"+D));break;case"accepted":t.onAccepted&&t.onAccepted(O),E=!0;break;case"disposed":t.onDisposed&&t.onDisposed(O),R=!0;break;default:throw new Error("Unexception type "+O.type)}if(x)return p("abort"),Promise.reject(x);if(E)for(c in _[c]=d[c],h(b,O.outdatedModules),O.outdatedDependencies)Object.prototype.hasOwnProperty.call(O.outdatedDependencies,c)&&(y[c]||(y[c]=[]),h(y[c],O.outdatedDependencies[c]));R&&(h(b,[O.moduleId]),_[c]=w)}var M,k=[];for(r=0;r<b.length;r++)c=b[r],I[c]&&I[c].hot._selfAccepted&&_[c]!==w&&k.push({module:c,errorHandler:I[c].hot._selfAccepted});p("dispose"),Object.keys(g).forEach((function(e){!1===g[e]&&function(e){delete installedChunks[e]}(e)}));for(var A,T,j=b.slice();j.length>0;)if(c=j.pop(),a=I[c]){var N={},B=a.hot._disposeHandlers;for(u=0;u<B.length;u++)(n=B[u])(N);for(i[c]=N,a.hot.active=!1,delete I[c],delete y[c],u=0;u<a.children.length;u++){var U=I[a.children[u]];U&&((M=U.parents.indexOf(c))>=0&&U.parents.splice(M,1))}}for(c in y)if(Object.prototype.hasOwnProperty.call(y,c)&&(a=I[c]))for(T=y[c],u=0;u<T.length;u++)A=T[u],(M=a.children.indexOf(A))>=0&&a.children.splice(M,1);for(c in p("apply"),o=v,_)Object.prototype.hasOwnProperty.call(_,c)&&(e[c]=_[c]);var C=null;for(c in y)if(Object.prototype.hasOwnProperty.call(y,c)&&(a=I[c])){T=y[c];var L=[];for(r=0;r<T.length;r++)if(A=T[r],n=a.hot._acceptedDependencies[A]){if(-1!==L.indexOf(n))continue;L.push(n)}for(r=0;r<L.length;r++){n=L[r];try{n(T)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:c,dependencyId:T[r],error:e}),t.ignoreErrored||C||(C=e)}}}for(r=0;r<k.length;r++){var W=k[r];c=W.module,s=[c];try{P(c)}catch(e){if("function"==typeof W.errorHandler)try{W.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:c,error:n,originalError:e}),t.ignoreErrored||C||(C=n),C||(C=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:c,error:e}),t.ignoreErrored||C||(C=e)}}return C?(p("fail"),Promise.reject(C)):(p("idle"),new Promise((function(e){e(b)})))}var I={};function P(t){if(I[t])return I[t].exports;var n=I[t]={i:t,l:!1,exports:{},hot:c(t),parents:(u=s,s=[],u),children:[]};return e[t].call(n.exports,n,n.exports,a(t)),n.l=!0,n.exports}P.m=e,P.c=I,P.d=function(e,t,n){P.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},P.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},P.t=function(e,t){if(1&t&&(e=P(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(P.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)P.d(n,r,function(t){return e[t]}.bind(null,r));return n},P.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return P.d(t,"a",t),t},P.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},P.p="",P.h=function(){return o},a(15)(P.s=15)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={DB:"DB error has been occurred",DEVELOPER_NOT_FOUND:"Developer not found",REPOSITORY_NOT_FOUND:"Repository not found",DEVELOPER_NOT_GIVEN:"Please set developer",REPOSITORY_NOT_GIVEN:"Please set repository",STASH_NAME_NOT_GIVEN:"Please set stash developer name",INVALID_SUBSCRIBE:"Invalid subscribe",STASH:"Stash error has been occurred"}},function(e,t,n){const r=n(9);n(21).config(),e.exports={PORT:process.env.PORT,BOT_TOKEN:"xoxb-734390477313-816073097493-SuWbxhMiKO7COxKatVXNxvG8",MONGO_URI:"mongodb://localhost:27017/slackbot",SIGNING_SECRET:"4c973edb8bbdfc1b995cecd53d1f9f09",SIGN_IN_URL:"http://localhost:3000/login",JWT_SECRET:"7jT2tX5nTMsbf6tfmRjcMSNS5dtVKunV",VERIFICATION_TOKEN:"fEZkLAi5u5teVlhxD6ZDNxAi",CLIENT_ID:"734390477313.815598116564",CLIENT_SECRET:"77d2b81a887e158c367062f5872fc599",BITBUCKET_CREDENTIALS:"YWxleGV5c3U6TmV3cGFzc3dvcmQxMjM0IQ==",JWT_DURATION:"20m",PUBLIC:r.resolve(__dirname,"dist")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),o=function(e){this.services=e,this.router=r.Router()};t.default=o},function(e,t){e.exports=require("mongoose")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(19)),u=n(20),a=n(1),c=a.JWT_SECRET,l=a.VERIFICATION_TOKEN;s.default.use(new u.Strategy({jwtFromRequest:function(e){return e.cookies&&e.cookies.token?e.cookies.token:null},secretOrKey:c},(function(e,t){return r(void 0,void 0,void 0,(function(){return o(this,(function(n){return e?t(!1,e):t(!0),[2]}))}))})));t.botAuth=function(e,t,n){e.body&&e.body.token===l?n():t.status(401).send({error:"Unauthorized"})};t.userAuth=function(e,t,n){s.default.authenticate("jwt",{session:!1},(function(e,r,o){e||o?t.status(401).send({error:"Unauthorized"}):n()}))(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={SUBSCRIBES:"/",DEVELOPERS:"/developers",REPOSITORIES:"/repositories",SETTINGS:"/settings",LOGIN:"/login/:token",REFRESH:"/refresh",API_AUTH:"/auth",API_USERS:"/api/users",API_FAVORITE_DEVELOPERS:"/api/favorite-developers",API_STASH_DEVELOPERS:"/api/stash-developers",API_FAVORITE_REPOSITORIES:"/api/favorite-repositories",API_STASH_REPOSITORIES:"/api/stash-repositories",API_SUBSCRIBES:"/api/subscribes",UNAUTHORIZED:"/unauthorized"}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.model=e}return e.prototype.add=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.model.update(e,{},{upsert:!0}).exec()];case 1:return[2,1===t.sent().ok]}}))}))},e.prototype.remove=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.model.deleteMany(e).exec()];case 1:return[2,1===t.sent().ok]}}))}))},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.message={blocks:[]}}return e.prototype.getMessage=function(){return this.message},e.prototype.getSection=function(e){return{type:"section",text:{type:"mrkdwn",text:e}}},e.prototype.getButton=function(e){return{type:"button",text:{type:"plain_text",text:e.btnText},value:e.btnValue}},e.prototype.getField=function(e){return{type:"mrkdwn",text:e}},e.prototype.getSectionWithButton=function(e,t){return r(r({},this.getSection(e)),{accessory:this.getButton(t)})},e.prototype.getSectionWithFields=function(e){var t=this;return{type:"section",fields:e.map((function(e){return t.getField(e)}))}},e.prototype.getActions=function(e){var t=this;return{type:"actions",elements:e.map((function(e){return t.getButton(e)}))}},e.prototype.buildChannelId=function(e){return this.message.channel=e,this},e.prototype.buildSection=function(e){return this.message.blocks.push(this.getSection(e)),this},e.prototype.buildDivider=function(){return this.message.blocks.push({type:"divider"}),this},e.prototype.buildSectionWithButton=function(e,t){return this.message.blocks.push(this.getSectionWithButton(e,t)),this},e.prototype.buildActions=function(e){return this.message.blocks.push(this.getActions(e)),this},e.prototype.buildSectionWithFields=function(e){return this.message.blocks.push(this.getSectionWithFields(e)),this},e}();t.default=o},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(27),a=s(n(0)),c=n(1).BOT_TOKEN,l=function(){function e(){this.webClient=new u.WebClient(c)}return e.prototype.post=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.webClient.chat.postMessage(r(r({text:e.text},e.msg),{channel:e.channelId}))];case 1:return t.sent(),[2]}}))}))},e.prototype.getProfile=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.webClient.users.info({user:e})];case 1:return(t=n.sent()).user?[2,t.user.profile]:[2,a.default.DEVELOPER_NOT_FOUND];case 2:return n.sent(),[2,a.default.DEVELOPER_NOT_FOUND];case 3:return[2]}}))}))},e}();t.default=l},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(44)),i=n(1).BITBUCKET_CREDENTIALS,s=o.default.create({baseURL:"https://stash.firmglobal.com/rest/api/1.0/",withCredentials:!0,headers:{Authorization:"Basic "+i}});t.default=s},function(e,t){e.exports=require("query-string")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14);t.default=function(e){return e.buildDivider().buildSection("*I support the following commands:*").buildDivider(),r.commandsDescription.forEach((function(t,n){e.buildSectionWithFields(["*"+(n+1)+") "+t.name+"*",t.description]).buildSection(t.hint).buildDivider()})),e.getMessage()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ADD_DEVELOPER:"add_developer",ADD_REPOSITORY:"add_repository",DEVELOPERS:"developers",REPOSITORIES:"repositories",SIGNUP:"signup",SUBSCRIBES:"subscribes",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",HELP:"help",HI:"hi",IAM:"I'm"};t.commands=r;var o=[{name:r.SUBSCRIBES,description:"*Show subscribes*",hint:'Write me "'+r.SUBSCRIBES+" to *get subscribes*"},{name:r.SUBSCRIBE,description:"*Subcribe* to PR",hint:"Write me "+r.SUBSCRIBE+' "RepositoryName" "DeveloperDisplayName" (for instance '+r.SUBSCRIBE+' "Confirmit.AppStudio.Client" "Alexey Sumatokhin.EXT") to *subscribe*'},{name:r.UNSUBSCRIBE,description:"*Unsubscribe* from PR",hint:"Write me "+r.UNSUBSCRIBE+' "RepositoryName" "DeveloperDisplayName" (for instance '+r.UNSUBSCRIBE+' "Confirmit.AppStudio.Client" "Alexey Sumatokhin.EXT") to *unsubscribe*'},{name:r.ADD_DEVELOPER,description:"*Add developer* into your favorites",hint:"Write me "+r.ADD_DEVELOPER+' "DeveloperDisplayName" (for instance '+r.ADD_DEVELOPER+' "Alexey Sumatokhin.EXT") to *add developer* into your favorites'},{name:r.ADD_REPOSITORY,description:"*Add repository* into your favorites",hint:"Write me "+r.ADD_REPOSITORY+' "RepositoryName" (for instance '+r.ADD_REPOSITORY+' "Confirmit.AppStudio.Client") to *add repository* into your favorites'},{name:r.REPOSITORIES,description:"*Show repositories* added into favorites",hint:'Write me "'+r.REPOSITORIES+'" to *get repositories* added into your favorites'},{name:r.DEVELOPERS,description:"*Show developers* added into favorites",hint:'Write me "'+r.DEVELOPERS+'" to *get developers* added into your favorites'},{name:r.SIGNUP,description:"*Sign up* for admin website",hint:"Write me "+r.SIGNUP+'" to get onetime link to *sign in admin website*'}];t.commandsDescription=o},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(8)),i=r(n(16)),s=r(n(17)),u=r(n(18)),a=r(n(22)),c=r(n(23)),l=r(n(24)),f=r(n(56)),p=r(n(57)),h=r(n(58)),d=r(n(59)),v=r(n(60)),y=r(n(65)),b=n(3),_=r(n(66)),w=n(1),g=w.PORT,S=w.MONGO_URI;b.connect(S,{useNewUrlParser:!0,keepAlive:!0});var m=o.default(),O=new p.default(new l.default);m.use(o.default.static(__dirname+"/dist")),m.use(s.default()),m.use(i.default.json()),m.use(i.default.urlencoded({extended:!0})),m.use(new h.default(O).makeRouter()),m.use(new y.default(O).makeRouter()),m.use(new d.default(O).makeRouter()),m.use(new u.default(O).makeRouter()),m.use(new a.default(O).makeRouter()),m.use(new c.default(O).makeRouter()),m.use(new f.default(O).makeRouter()),m.use(new _.default(O).makeRouter()),new v.default(O).start(),m.listen(g)},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cookie-parser")},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(2)),l=n(4),f=a(n(5)),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.postDevelopersList=function(e,t){return i(this,void 0,void 0,(function(){var n,r,o,i,a;return s(this,(function(s){switch(s.label){case 0:return n=e.query,r=n.search,o=n.limit,i=u(n,["search","limit"]),[4,this.services.developerService.list({filter:i,search:r,limit:o})];case 1:return a=s.sent(),t.send(a),[2]}}))}))},t.prototype.postStashDevelopersList=function(e,t){return i(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,this.services.stashDeveloperService.list(e.query)];case 1:return n=r.sent(),t.send(n),[2]}}))}))},t.prototype.postDeveloperDeleteResult=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return[4,this.services.developerService.delete(e.query)];case 1:return n=o.sent(),r=n?200:404,t.status(r).send(),[2]}}))}))},t.prototype.postAddStashDeveloperToFavoritesResult=function(e,t){return i(this,void 0,void 0,(function(){var n,r,o,i;return s(this,(function(s){switch(s.label){case 0:return[4,this.services.developerService.add(e.body)];case 1:return n=s.sent(),o=(r="string"==typeof n)?404:200,i=r?n:"ok",t.status(o).send(i),[2]}}))}))},t.prototype.makeRouter=function(){return this.router.get(f.default.API_FAVORITE_DEVELOPERS,l.userAuth,this.postDevelopersList.bind(this)),this.router.post(f.default.API_FAVORITE_DEVELOPERS,l.userAuth,this.postAddStashDeveloperToFavoritesResult.bind(this)),this.router.get(f.default.API_STASH_DEVELOPERS,l.userAuth,this.postStashDevelopersList.bind(this)),this.router.delete(f.default.API_FAVORITE_DEVELOPERS,l.userAuth,this.postDeveloperDeleteResult.bind(this)),this.router},t}(c.default);t.default=p},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("passport-jwt")},function(e,t){e.exports=require("dotenv")},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=c(n(2)),f=n(4),p=c(n(5)),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.postSubscribesList=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o,i,s;return u(this,(function(u){switch(u.label){case 0:return n=e.query,r=n.search,o=n.limit,i=a(n,["search","limit"]),[4,this.services.subscribeService.list({search:r,limit:o,filter:i})];case 1:return s=u.sent(),t.send(s),[2]}}))}))},t.prototype.postAddSubscribeResult=function(e,t){return s(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return[4,this.services.subscribeService.subscribe(e.body)];case 1:return n=r.sent(),t.send(n),[2]}}))}))},t.prototype.postEditSubscribeResult=function(e,t){return s(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return[4,this.services.subscribeService.editSubscribe(i(i({},e.body),{id:e.params.id}))];case 1:return n=r.sent(),t.send(n),[2]}}))}))},t.prototype.postSubscribeDeleteResult=function(e,t){return s(this,void 0,void 0,(function(){var n,r;return u(this,(function(o){switch(o.label){case 0:return[4,this.services.subscribeService.unsubscribe(e.query)];case 1:return n=o.sent(),r=n?200:404,t.status(r).send(),[2]}}))}))},t.prototype.makeRouter=function(){return this.router.get(p.default.API_SUBSCRIBES,f.userAuth,this.postSubscribesList.bind(this)),this.router.post(p.default.API_SUBSCRIBES,f.userAuth,this.postAddSubscribeResult.bind(this)),this.router.put(p.default.API_SUBSCRIBES+"/:id",f.userAuth,this.postEditSubscribeResult.bind(this)),this.router.delete(p.default.API_SUBSCRIBES,f.userAuth,this.postSubscribeDeleteResult.bind(this)),this.router},t}(l.default);t.default=h},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(2)),l=n(4),f=a(n(5)),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.postRepositoriesList=function(e,t){return i(this,void 0,void 0,(function(){var n,r,o,i,a;return s(this,(function(s){switch(s.label){case 0:return n=e.query,r=n.search,o=n.limit,i=u(n,["search","limit"]),[4,this.services.repositoryService.list({search:r,limit:o,filter:i})];case 1:return a=s.sent(),t.send(a),[2]}}))}))},t.prototype.postStashRepositoriesList=function(e,t){return i(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,this.services.stashRepositoryService.list(e.query)];case 1:return n=r.sent(),t.send(n),[2]}}))}))},t.prototype.postRepositoryDeleteResult=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return[4,this.services.repositoryService.delete(e.query)];case 1:return n=o.sent(),r=n?200:404,t.status(r).send(),[2]}}))}))},t.prototype.postAddStashRepositoryToFavoritesResult=function(e,t){return i(this,void 0,void 0,(function(){var n,r,o,i;return s(this,(function(s){switch(s.label){case 0:return[4,this.services.repositoryService.add(e.body)];case 1:return n=s.sent(),o=(r="string"==typeof n)?404:200,i=r?n:"ok",t.status(o).send(i),[2]}}))}))},t.prototype.makeRouter=function(){return this.router.get(f.default.API_FAVORITE_REPOSITORIES,l.userAuth,this.postRepositoriesList.bind(this)),this.router.post(f.default.API_FAVORITE_REPOSITORIES,l.userAuth,this.postAddStashRepositoryToFavoritesResult.bind(this)),this.router.get(f.default.API_STASH_REPOSITORIES,l.userAuth,this.postStashRepositoriesList.bind(this)),this.router.delete(f.default.API_FAVORITE_REPOSITORIES,l.userAuth,this.postRepositoryDeleteResult.bind(this)),this.router},t}(c.default);t.default=p},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(25)),i=r(n(10)),s=r(n(28)),u=r(n(29)),a=r(n(31)),c=r(n(33)),l=r(n(34)),f=r(n(35)),p=r(n(37)),h=r(n(39)),d=r(n(41)),v=r(n(43)),y=r(n(45)),b=r(n(46)),_=r(n(47)),w=r(n(49)),g=r(n(50)),S=r(n(52)),m=r(n(54)),O=function(){function e(){}return e.prototype.getAuthService=function(){return new h.default},e.prototype.getSessionService=function(){return new w.default(new g.default)},e.prototype.getNotifyService=function(){return new m.default(new i.default,new o.default,new _.default)},e.prototype.getRepositoryService=function(){return new s.default(new u.default,new o.default,this.getStashRepositoryService())},e.prototype.getSubscribeService=function(){return new c.default(new o.default,new u.default,new f.default,this.getRepositoryService(),this.getDeveloperService(),this.getStashDeveloperService(),this.getStashRepositoryService())},e.prototype.getDeveloperService=function(){return new l.default(new f.default,new o.default,this.getStashDeveloperService())},e.prototype.getUserService=function(){return new b.default(new _.default,this.getStashDeveloperService())},e.prototype.getStashDeveloperService=function(){return new v.default(new f.default)},e.prototype.getStashRepositoryService=function(){return new y.default(new u.default)},e.prototype.getRepositoryToMsgAdapter=function(){return new a.default(this.getRepositoryService())},e.prototype.getDeveloperToMsgAdapter=function(){return new p.default(this.getDeveloperService())},e.prototype.getSessionToMessageAdapter=function(){return new S.default(this.getSessionService())},e.prototype.getSubscribeToMessageAdapter=function(){return new d.default(this.getSubscribeService())},e}();t.default=O},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(26),c=function(e){function t(){return e.call(this,a.SubscribeModel)||this}return o(t,e),t.prototype.get=function(e,t,n){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.model.find(e).sort({reponame:1}).exec()];case 1:return[2,t.sent().map((function(e){return{channelId:e.channelId,followed:e.followed,follower:e.follower,reponame:e.reponame,id:e._id,followedEmail:e.followedEmail,repoUrl:e.repoUrl}}))]}}))}))},t.prototype.edit=function(e){return this.model.update({_id:e.id},e).exec()},t}(u(n(6)).default);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=new r.Schema({channelId:String,followed:String,followedEmail:String,follower:String,reponame:String,repoUrl:String}),i=r.model("Subscribe",o);t.SubscribeModel=i},function(e,t){e.exports=require("@slack/web-api")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(0)),u=function(){function e(e,t,n){this.repositoryStorageService=e,this.subscribeStorageService=t,this.repositoryStashService=n}return e.prototype.list=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){return t=e.filter,n=e.search,r=e.limit,[2,this.repositoryStorageService.get(t,n,r)]}))}))},e.prototype.add=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return 0===e.reponame.length?[3,4]:[4,this.repositoryStashService.getValidRepository(e.reponame)];case 1:return"string"==typeof(t=n.sent())?[3,3]:(e.url=t.links.self[0].href,[4,this.repositoryStorageService.add(e)]);case 2:return[2,n.sent()?e:s.default.DB];case 3:return[2,t];case 4:return[2,s.default.DEVELOPER_NOT_GIVEN]}}))}))},e.prototype.delete=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,s,u;return o(this,(function(o){switch(o.label){case 0:return[4,this.repositoryStorageService.get(e)];case 1:return 0===(t=o.sent()).length?[2,!1]:(n=t[0],r=n.reponame,i=n.channelId,[4,this.repositoryStorageService.remove({reponame:r,channelId:i})]);case 2:return s=o.sent(),[4,this.subscribeStorageService.remove({reponame:r,channelId:i})];case 3:return u=o.sent(),[2,s&&u]}}))}))},e}();t.default=u},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(6)),l=n(30),f=n(3),p=function(e){function t(){return e.call(this,l.FavoriteRepositoryModel)||this}return o(t,e),t.prototype.get=function(e){return i(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=e.id,n=u(e,["id"]),t&&(n._id=f.Types.ObjectId(t)),[4,this.model.find(n).sort({reponame:1}).exec()];case 1:return[2,r.sent().map((function(e){return{reponame:e.reponame,url:e.url,channelId:e.channelId,addedByName:e.addedByName,id:e._id}}))]}}))}))},t}(c.default);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=new r.Schema({channelId:String,addedByName:String,reponame:String,url:String}),i=r.model("Repo",o);t.FavoriteRepositoryModel=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(32)),u=i(n(0)),a=function(){function e(e){this.repositoryService=e}return e.prototype.getReposListMsg=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return[4,this.repositoryService.list({filter:{channelId:t}})];case 1:return 0===(n=r.sent()).length?("You don't have added repositories yet. To add them please use command /add_repository",[2,e.buildSection("You don't have added repositories yet. To add them please use command /add_repository").getMessage()]):[2,s.default(e,n)]}}))}))},e.prototype.getAddResultMsg=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return t.reponame?[4,this.repositoryService.add(t)]:[3,2];case 1:return"string"!=typeof(n=r.sent())?e.buildSection("You have added new repository "+t.reponame):e.buildSection(n),[3,3];case 2:e.buildSection(u.default.REPOSITORY_NOT_GIVEN),r.label=3;case 3:return[2,e.getMessage()]}}))}))},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return e.buildDivider().buildSection("*Added repositories:*").buildDivider(),t.forEach((function(t){e.buildSection(t.reponame).buildDivider()})),e.getMessage()}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(0)),a=function(){function e(e,t,n,r,o,i,s){this.subscribeStorageService=e,this.repositoryStorageService=t,this.developerStorageService=n,this.repositoryService=r,this.developerService=o,this.stashDeveloperService=i,this.stashRepositoryService=s}return e.prototype.list=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){return t=e.filter,n=e.search,r=e.limit,[2,this.subscribeStorageService.get(t,n,r)]}))}))},e.prototype.validateSubscribe=function(e){return o(this,void 0,void 0,(function(){var t,n,o,s,a,c,l,f,p;return i(this,(function(i){switch(i.label){case 0:return t=e.channelId,n=e.followed,o=e.follower,s=e.reponame,[4,this.stashDeveloperService.getValidDeveloper(n)];case 1:return a=i.sent(),[4,this.stashRepositoryService.getValidRepository(s)];case 2:return c=i.sent(),l="string"!=typeof a?{channelId:t,username:n,addedByName:o,email:a.emailAddress}:a,f="string"!=typeof c?{channelId:t,reponame:s,addedByName:o,url:c.links.self[0].href}:c,p="string"!=typeof l&&"string"!=typeof f?r(r({},e),{followedEmail:l.email,repoUrl:f.url}):u.default.INVALID_SUBSCRIBE,[2,{developer:l,repository:f,subscribe:p}]}}))}))},e.prototype.subscribe=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,this.validateSubscribe(e)];case 1:return t=i.sent(),n=t.developer,r=t.repository,"string"==typeof(o=t.subscribe)||"string"==typeof n||"string"==typeof r?[3,5]:[4,this.developerStorageService.add(n)];case 2:return n=i.sent()?n:u.default.DB,[4,this.repositoryStorageService.add(r)];case 3:return r=i.sent()?r:u.default.DB,[4,this.subscribeStorageService.add(o)];case 4:o=i.sent()?o:u.default.DB,i.label=5;case 5:return[2,{developer:n,repository:r,subscribe:o}]}}))}))},e.prototype.unsubscribe=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){return[2,this.subscribeStorageService.remove(e)]}))}))},e.prototype.editSubscribe=function(e){return o(this,void 0,void 0,(function(){var t,n,o,s,a;return i(this,(function(i){switch(i.label){case 0:return[4,this.validateSubscribe(e)];case 1:return t=i.sent(),n=t.developer,o=t.repository,"string"==typeof(s=t.subscribe)||"string"==typeof n||"string"==typeof o?[3,5]:[4,this.developerStorageService.add(n)];case 2:return n=i.sent()?n:u.default.DB,[4,this.repositoryStorageService.add(o)];case 3:return o=i.sent()?o:u.default.DB,a=r(r({},s),{id:e.id}),[4,this.subscribeStorageService.edit(a)];case 4:s=i.sent()?s:u.default.DB,i.label=5;case 5:return[2,{developer:n,repository:o,subscribe:s}]}}))}))},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(0)),u=function(){function e(e,t,n){this.developerStorageService=e,this.subscribeStorageService=t,this.developerStashService=n}return e.prototype.list=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return t=e.search,n=e.limit,r=e.filter,[4,this.developerStorageService.get(r,t,n)];case 1:return[2,o.sent()]}}))}))},e.prototype.add=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return 0===e.username.length?[3,4]:[4,this.developerStashService.getValidDeveloper(e.username)];case 1:return"string"==typeof(t=n.sent())?[3,3]:(e.email=t.emailAddress,[4,this.developerStorageService.add(e)]);case 2:return[2,n.sent()?e:s.default.DB];case 3:return[2,t];case 4:return[2,s.default.DEVELOPER_NOT_GIVEN]}}))}))},e.prototype.delete=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,s,u;return o(this,(function(o){switch(o.label){case 0:return[4,this.developerStorageService.get(e)];case 1:return 0===(t=o.sent()).length?[2,!1]:(n=t[0],r=n.username,i=n.channelId,[4,this.developerStorageService.remove({username:r,channelId:i})]);case 2:return s=o.sent(),[4,this.subscribeStorageService.remove({followed:r,channelId:i})];case 3:return u=o.sent(),[2,s&&u]}}))}))},e}();t.default=u},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(6)),l=n(36),f=n(3),p=function(e){function t(){return e.call(this,l.FavoriteDeveloperModel)||this}return o(t,e),t.prototype.get=function(e){return i(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=e.id,n=u(e,["id"]),t&&(n._id=f.Types.ObjectId(t)),[4,this.model.find(n).sort({username:1}).exec()];case 1:return[2,r.sent().map((function(e){return{username:e.username,email:e.email,channelId:e.channelId,addedByName:e.addedByName,id:e._id}}))]}}))}))},t}(c.default);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=new r.Schema({channelId:String,addedByName:String,username:String,email:String}),i=r.model("Developer",o);t.FavoriteDeveloperModel=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(38)),u=i(n(0)),a=function(){function e(e){this.developerService=e}return e.prototype.getDevelopersListMsg=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return n="You don't have added developers yet. To add them please use command /add_developer",[4,this.developerService.list({filter:{channelId:t}})];case 1:return 0===(r=o.sent()).length?[2,e.buildSection(n).getMessage()]:[2,s.default(e,r)]}}))}))},e.prototype.getAddResultMsg=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return t.username?[4,this.developerService.add(t)]:[3,2];case 1:return"string"!=typeof(n=r.sent())?e.buildSection("You have added new developer "+t.username):e.buildSection(n),[3,3];case 2:e.buildSection(u.default.DEVELOPER_NOT_GIVEN),r.label=3;case 3:return[2,e.getMessage()]}}))}))},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return e.buildDivider().buildSection("*Added developers:*").buildDivider(),t.forEach((function(t){e.buildSection(t.username).buildDivider()})),e.getMessage()}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(40),s=n(1).JWT_SECRET,u=function(){function e(){}return e.prototype.createJWT=function(e,t){return i.sign(e,s,t)},e.prototype.verifyJWT=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i.verify(e,s)];case 1:return[2,t.sent()];case 2:return t.sent(),[2,!1];case 3:return[2]}}))}))},e}();t.default=u},function(e,t){e.exports=require("jsonwebtoken")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(42)),u=function(){function e(e){this.subscribeService=e}return e.prototype.getSubscribesListMsg=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return n="You don't have subscribes yet. To add them please sign in admin site",[4,this.subscribeService.list({filter:{channelId:t}})];case 1:return 0===(r=o.sent()).length?[2,e.buildSection(n).getMessage()]:[2,s.default(e,r)]}}))}))},e.prototype.getAddResultMsg=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return t.followed&&t.reponame?[4,this.subscribeService.subscribe(t)]:[3,2];case 1:return"string"!=typeof(n=r.sent()).subscribe?e.buildSection("You have subscribed for "+t.followed+"'s PR into "+t.reponame):e.buildSection(n.subscribe),[3,3];case 2:e.buildSection("Incorrect params"),r.label=3;case 3:return[2,e.getMessage()]}}))}))},e.prototype.getDeleteResultMsg=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return t.followed&&t.reponame?[4,this.subscribeService.unsubscribe(t)]:[3,2];case 1:return n.sent()?e.buildSection("You have unsubscribed from "+t.followed+"'s PR into "+t.reponame):e.buildSection("DB Error has been occurred"),[3,3];case 2:e.buildSection("Incorrect params"),n.label=3;case 3:return[2,e.getMessage()]}}))}))},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return e.buildDivider().buildSection("*Your subscribes:*").buildDivider(),t.forEach((function(t){e.buildSectionWithFields([t.reponame,t.followed]).buildDivider()})),e.getMessage()}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(11)),a=s(n(12)),c=s(n(0)),l=function(){function e(e){this.developerStorageService=e}return e.prototype.clearData=function(e,t){return o(this,void 0,void 0,(function(){var n,o,s,u,a,c,l;return i(this,(function(i){switch(i.label){case 0:n=[],o=0,s=t,i.label=1;case 1:return o<s.length?(u=s[o],[4,this.developerStorageService.get({channelId:e,username:u.displayName})]):[3,4];case 2:a=i.sent(),c=0!==a.length,l=c?a[0].id:"",n.push(r(r({},u),{isFavorite:c,favoriteId:l})),i.label=3;case 3:return o++,[3,1];case 4:return[2,n]}}))}))},e.prototype.list=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,s;return i(this,(function(i){switch(i.label){case 0:t=e.channelId,n=e.filter,r="/users?"+a.default.stringify({limit:1e3,filter:n}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,u.default.get(r)];case 2:return o=i.sent(),s=o.data.values,[2,this.clearData(t,s)];case 3:return i.sent(),[2,!1];case 4:return[2]}}))}))},e.prototype.getValidDeveloper=function(e){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:t="/users?"+a.default.stringify({filter:e}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,u.default.get(t)];case 2:return n=r.sent(),[2,n.data.values.find((function(t){return t.displayName.toLowerCase()===e.toLowerCase()||t.emailAddress.toLowerCase()===e.toLowerCase()}))||c.default.DEVELOPER_NOT_FOUND];case 3:return r.sent(),[2,c.default.STASH];case 4:return[2]}}))}))},e}();t.default=l},function(e,t){e.exports=require("axios")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(11)),u=i(n(12)),a=i(n(0)),c=function(){function e(e){this.repositoryStorageService=e}return e.prototype.clearData=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,s,u,a,c,l,f;return o(this,(function(o){switch(o.label){case 0:n=[],r=0,i=t,o.label=1;case 1:return r<i.length?(s=i[r],u=s.links.self[0].href,a=s.name,[4,this.repositoryStorageService.get({channelId:e,reponame:a})]):[3,4];case 2:c=o.sent(),l=0!==c.length,f=l?c[0].id:"",n.push({isFavorite:l,favoriteId:f,url:u,name:a}),o.label=3;case 3:return r++,[3,1];case 4:return[2,n]}}))}))},e.prototype.list=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,a;return o(this,(function(o){switch(o.label){case 0:t=e.channelId,n=e.name,r="/repos?"+u.default.stringify({limit:1e3,name:n}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.default.get(r)];case 2:return i=o.sent(),a=i.data.values,[2,this.clearData(t,a)];case 3:return o.sent(),[2,!1];case 4:return[2]}}))}))},e.prototype.getValidRepository=function(e){return r(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:t="/repos?"+u.default.stringify({name:e}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.default.get(t)];case 2:return n=r.sent(),[2,n.data.values.find((function(t){return t.name===e}))||a.default.REPOSITORY_NOT_FOUND];case 3:return r.sent(),[2,a.default.STASH];case 4:return[2]}}))}))},e}();t.default=c},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(0)),u=function(){function e(e,t){this.userStorageService=e,this.developerStashService=t}return e.prototype.list=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return t=e.search,n=e.limit,r=e.filter,[4,this.userStorageService.get(r,t,n)];case 1:return[2,o.sent()]}}))}))},e.prototype.add=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return 0===e.stashDisplayName.length?[3,4]:[4,this.developerStashService.getValidDeveloper(e.stashDisplayName)];case 1:return"string"==typeof(t=n.sent())?[3,3]:(e.stashSlug=t.slug,[4,this.userStorageService.add(e)]);case 2:return[2,n.sent()?e:s.default.DB];case 3:return[2,t];case 4:return[2,s.default.STASH_NAME_NOT_GIVEN]}}))}))},e.prototype.delete=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.userStorageService.remove(e)];case 1:return[2,t.sent()]}}))}))},e}();t.default=u},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(48),c=function(e){function t(){return e.call(this,a.UserModel)||this}return o(t,e),t.prototype.get=function(e,t,n){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.model.find(e).exec()];case 1:return[2,t.sent().map((function(e){return{channelId:e.channelId,stashDisplayName:e.stashDisplayName,stashSlug:e.stashSlug,id:e._id,commentsNotifications:e.commentsNotifications,reviewNotifications:e.reviewNotifications,subscribesNotifications:e.subscribesNotifications}}))]}}))}))},t.prototype.add=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.model.update({channelId:e.channelId},e,{upsert:!0}).exec()]}))}))},t.prototype.edit=function(e){return this.model.update({_id:e.id},e).exec()},t}(u(n(6)).default);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=new r.Schema({channelId:String,stashDisplayName:String,stashSlug:String,commentsNotifications:Boolean,reviewNotifications:Boolean,subscribesNotifications:Boolean}),i=r.model("User",o);t.UserModel=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(0)),u=function(){function e(e){this.sessionStorageService=e}return e.prototype.list=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return t=e.search,n=e.limit,r=e.filter,[4,this.sessionStorageService.get(r,t,n)];case 1:return[2,o.sent()]}}))}))},e.prototype.add=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.sessionStorageService.add(e)];case 1:return[2,t.sent()?e:s.default.DB]}}))}))},e.prototype.delete=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.sessionStorageService.remove(e)];case 1:return[2,t.sent()]}}))}))},e}();t.default=u},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(51),c=function(e){function t(){return e.call(this,a.SessionModel)||this}return o(t,e),t.prototype.get=function(e,t,n){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.model.find(e).exec()];case 1:return[2,t.sent().map((function(e){return{channelId:e.channelId,sid:e.sid}}))]}}))}))},t.prototype.add=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.model.update({channelId:e.channelId},e,{upsert:!0}).exec()]}))}))},t}(u(n(6)).default);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=new r.Schema({channelId:String,sid:String}),i=r.model("Session",o);t.SessionModel=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(53)),u=n(1).SIGN_IN_URL,a=function(){function e(e){this.sessionService=e}return e.prototype.getCreateAuthLinkMsg=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,a,c;return o(this,(function(o){switch(o.label){case 0:return n=Math.floor(Date.now()/1e3).toString(),r=s.default.createHash("sha1").update(n).digest("hex"),i={channelId:t,sid:r},[4,this.sessionService.add(i)];case 1:return a=o.sent(),c="string"!=typeof a?"To sign in to admin site please follow "+u+"/"+r:a,[2,e.buildSection(c).buildDivider().getMessage()]}}))}))},e}();t.default=a},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,u=i.length;s<u;s++,o++)r[o]=i[s];return r},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(55)),a=s(n(7)),c=function(){function e(e,t,n){this.webChatAdapter=e,this.subscribeStorageService=t,this.userStorageService=n}return e.prototype.getSubscribersChannelId=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,s,u,a;return o(this,(function(o){switch(o.label){case 0:return[4,this.subscribeStorageService.get({followed:e,reponame:t})];case 1:n=o.sent(),r=n.map((function(e){return e.channelId})),i=[],s=0,u=r,o.label=2;case 2:return s<u.length?(a=u[s],[4,this.userStorageService.get({channelId:a,subscribesNotifications:!0})]):[3,5];case 3:0!==o.sent().length&&i.push(a),o.label=4;case 4:return s++,[3,2];case 5:return[2,i]}}))}))},e.prototype.getMentionedAsReviewerChannelId=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,s;return o(this,(function(o){switch(o.label){case 0:t=[],n=0,r=e,o.label=1;case 1:return n<r.length?(i=r[n],[4,this.userStorageService.get({stashSlug:i,reviewNotifications:!0})]):[3,4];case 2:0!==(s=o.sent()).length&&s[0].channelId&&t.push(s[0].channelId),o.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},e.prototype.getMentionedInCommentChannelId=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,s,u;return o(this,(function(o){switch(o.label){case 0:if(t=[],!(n=e.text.match(/@\w*/g)))return[3,4];n=n.map((function(e){return e.slice(1).toLowerCase()})),r=0,i=n,o.label=1;case 1:return r<i.length?(s=i[r],[4,this.userStorageService.get({stashSlug:s,commentsNotifications:!0})]):[3,4];case 2:0!==(u=o.sent()).length&&u[0].channelId&&t.push(u[0].channelId),o.label=3;case 3:return r++,[3,1];case 4:return[2,t]}}))}))},e.prototype.notify=function(e){return r(this,void 0,void 0,(function(){var t,n,s,c,l,f,p,h,d,v,y=this;return o(this,(function(b){switch(b.label){case 0:switch(t=[],n={header:"",repositoryName:e.pullRequest.fromRef.repository.name,source:e.pullRequest.fromRef.displayId,destination:e.pullRequest.toRef.displayId,comment:e.comment&&e.comment.text},s=e.pullRequest.id,c=e.pullRequest.title,l=e.pullRequest.links.self[0].href,f=e.actor.displayName,e.eventKey){case"pr:opened":return[3,1];case"pr:reviewer:updated":return[3,6];case"pr:comment:added":return[3,8]}return[3,11];case 1:return n.header="*"+f+"* opened pull request <"+l+"|#"+s+": "+c+">",[4,this.getSubscribersChannelId(f,n.repositoryName)];case 2:return h=b.sent(),e.comment?[4,this.getMentionedInCommentChannelId(e.comment)]:[3,4];case 3:return v=b.sent(),[3,5];case 4:v=[],b.label=5;case 5:return d=v,t=Array.from(new Set(i(h,d))),[3,11];case 6:return n.header="*"+f+"* selected you as reviewer in pull request <"+l+"|#"+s+": "+c+">",[4,this.getMentionedAsReviewerChannelId(e.pullRequest.reviewers.map((function(e){return e.user.slug})))];case 7:return t=b.sent(),[3,11];case 8:return e.comment?(n.header="*"+f+"* commented on pull request <"+l+"|#"+s+": "+c+">",[4,this.getMentionedInCommentChannelId(e.comment)]):[3,10];case 9:t=b.sent(),b.label=10;case 10:return[3,11];case 11:return p=u.default(new a.default,n),t.map((function(e){return r(y,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.webChatAdapter.post({text:"",msg:p,channelId:e})];case 1:return t.sent(),[2]}}))}))})),[2]}}))}))},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var n=t.header,r=t.repositoryName,o=t.source,i=t.destination,s=t.comment;return e.buildDivider().buildSection(n),s&&e.buildSection(s),e.buildSectionWithFields(["*Source:* "+r+" - "+o,"*Destination:* "+r+" - "+i]).buildDivider(),e.getMessage()}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.notifyAboutPR=function(e,t){return i(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return console.log(JSON.stringify(e.body,null,2)),t.status(200).send(),[4,this.services.notifyService.notify(e.body)];case 1:return n.sent(),[2]}}))}))},t.prototype.makeRouter=function(){return this.router.post("/push",this.notifyAboutPR.bind(this)),this.router},t}(u(n(2)).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.authService=e.getAuthService(),this.sessionService=e.getSessionService(),this.developerService=e.getDeveloperService(),this.userService=e.getUserService(),this.stashDeveloperService=e.getStashDeveloperService(),this.stashRepositoryService=e.getStashRepositoryService(),this.repositoryService=e.getRepositoryService(),this.subscribeService=e.getSubscribeService(),this.notifyService=e.getNotifyService(),this.developerMessageAdapter=e.getDeveloperToMsgAdapter(),this.repositoryMessageAdapter=e.getRepositoryToMsgAdapter(),this.sessionToMessageAdapter=e.getSessionToMessageAdapter(),this.subscribeToMessageAdapter=e.getSubscribeToMessageAdapter()};t.default=r},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=a(n(2)),l=a(n(5)),f=n(1).JWT_DURATION,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.setJWT=function(e,t){return s(this,void 0,void 0,(function(){var n,r;return u(this,(function(o){switch(o.label){case 0:return[4,this.services.sessionService.list({filter:{sid:e.params.token}})];case 1:return 0===(n=o.sent()).length?[3,4]:[4,this.services.sessionService.delete(n[0])];case 2:return o.sent(),[4,this.services.authService.createJWT({channelId:n[0].channelId},{expiresIn:f})];case 3:return r=o.sent(),t.cookie("token",r,{httpOnly:!0}),t.redirect("/"),[3,5];case 4:t.status(401).send(),o.label=5;case 5:return[2]}}))}))},t.prototype.refreshJWT=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o;return u(this,(function(i){switch(i.label){case 0:return[4,this.services.authService.verifyJWT(e.cookies.token)];case 1:return(n=i.sent())?[4,this.services.authService.createJWT({channelId:n.channelId},{expiresIn:f})]:[3,4];case 2:return r=i.sent(),[4,this.services.authService.verifyJWT(r)];case 3:return o=i.sent(),t.cookie("token",r,{httpOnly:!0}),t.status(200).send({exp:o.exp}),[3,5];case 4:t.status(401).send(),i.label=5;case 5:return[2]}}))}))},t.prototype.postAuthData=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o,s,a;return u(this,(function(u){switch(u.label){case 0:return e.cookies&&e.cookies.token?[4,this.services.authService.verifyJWT(e.cookies.token)]:[3,7];case 1:return(n=u.sent())?[4,this.services.userService.list({filter:{channelId:n.channelId}})]:[3,5];case 2:return r=u.sent(),[4,this.services.authService.createJWT({channelId:n.channelId},{expiresIn:f})];case 3:return o=u.sent(),[4,this.services.authService.verifyJWT(o)];case 4:return s=u.sent(),t.cookie("token",o,{httpOnly:!0}),r.length>0?(a=r[0],t.status(200).send(i(i({},a),{exp:s.exp}))):t.status(200).send({channelId:s.channelId,exp:s.exp}),[3,6];case 5:t.status(401).send(),u.label=6;case 6:return[3,8];case 7:t.status(404).send(),u.label=8;case 8:return[2]}}))}))},t.prototype.makeRouter=function(){return this.router.get(l.default.LOGIN,this.setJWT.bind(this)),this.router.get(l.default.REFRESH,this.refreshJWT.bind(this)),this.router.get(l.default.API_AUTH,this.postAuthData.bind(this)),this.router},t}(c.default);t.default=p},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(2)),u=i(n(7)),a=n(4),c=i(n(13)),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.postMsgWithSlashCommands=function(e,t){e.body.channel_id,c.default(new u.default)},t.prototype.makeRouter=function(){return this.router.post("/help",a.botAuth,this.postMsgWithSlashCommands.bind(this)),this.router},t}(s.default);t.default=l},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,u=i.length;s<u;s++,o++)r[o]=i[s];return r},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(61),a=n(62),c=s(n(7)),l=s(n(10)),f=s(n(13)),p=n(14),h=s(n(63)),d=s(n(64)),v=n(1).BOT_TOKEN,y=function(){function e(e){this.services=e,this.rtm=new u.RTMClient(v),this.ee=new a.EventEmitter}return e.prototype.postMessage=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,(new l.default).post({text:"",msg:e,channelId:t})];case 1:return n.sent(),[2]}}))}))},e.prototype.postMsgWithDeveloperAdditionResult=function(e,t,n){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return[4,this.services.developerMessageAdapter.getAddResultMsg(new c.default,{channelId:e,username:n,addedByName:t})];case 1:return r=o.sent(),this.postMessage(r,e),[2]}}))}))},e.prototype.postMsgWithRepositoryAdditionResult=function(e,t,n){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return[4,this.services.repositoryMessageAdapter.getAddResultMsg(new c.default,{channelId:e,addedByName:t,reponame:n})];case 1:return r=o.sent(),this.postMessage(r,e),[2]}}))}))},e.prototype.postMsgWithDevelopersList=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.services.developerMessageAdapter.getDevelopersListMsg(new c.default,e)];case 1:return t=n.sent(),this.postMessage(t,e),[2]}}))}))},e.prototype.postMsgWithRepositoryList=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.services.repositoryMessageAdapter.getReposListMsg(new c.default,e)];case 1:return t=n.sent(),this.postMessage(t,e),[2]}}))}))},e.prototype.postMsgWithSubscribesList=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.services.subscribeToMessageAdapter.getSubscribesListMsg(new c.default,e)];case 1:return t=n.sent(),this.postMessage(t,e),[2]}}))}))},e.prototype.postMsgWithAuthLink=function(e,t){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.services.sessionToMessageAdapter.getCreateAuthLinkMsg(new c.default,e)];case 1:return t=n.sent(),this.postMessage(t,e),[2]}}))}))},e.prototype.postMsgWithSubscribeAdditionResult=function(e,t,n,i){return r(this,void 0,void 0,(function(){var r,s;return o(this,(function(o){switch(o.label){case 0:return r={follower:t,reponame:n,channelId:e,followed:i,followedEmail:"",repoUrl:""},[4,this.services.subscribeToMessageAdapter.getAddResultMsg(new c.default,r)];case 1:return s=o.sent(),this.postMessage(s,e),[2]}}))}))},e.prototype.postMsgWithSubscribeRemoveResult=function(e,t,n,i){return r(this,void 0,void 0,(function(){var r,s;return o(this,(function(o){switch(o.label){case 0:return r={follower:t,reponame:n,channelId:e,followed:i},[4,this.services.subscribeToMessageAdapter.getDeleteResultMsg(new c.default,r)];case 1:return s=o.sent(),this.postMessage(s,e),[2]}}))}))},e.prototype.postMsgWithCommands=function(e){var t=f.default(new c.default);this.postMessage(t,e)},e.prototype.postMsgWithGreeting=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,this.services.userService.list({filter:{channelId:e}})];case 1:return t=o.sent(),n=0!==t.length,r=n?t[0].stashDisplayName:"",i=h.default(new c.default,n,r),this.postMessage(i,e),[2]}}))}))},e.prototype.postMsgAddStashNameResult=function(e,t,n){return r(this,void 0,void 0,(function(){var t,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,this.services.userService.add({channelId:e,stashDisplayName:n,subscribesNotifications:!0,commentsNotifications:!1,reviewNotifications:!1})];case 1:return t=o.sent(),r="string"!=typeof t?"Nice to meet you "+n:t,i=d.default(new c.default,r),this.postMessage(i,e),[2]}}))}))},e.prototype.addUserIfNotExist=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,this.services.userService.list({filter:{channelId:e}})];case 1:return 0!==o.sent().length?[3,4]:[4,this.services.stashDeveloperService.getValidDeveloper(t)];case 2:return"string"==typeof(n=o.sent())?[3,4]:(r=n.displayName,i=n.slug,[4,this.services.userService.add({channelId:e,stashDisplayName:r,stashSlug:i,subscribesNotifications:!0,commentsNotifications:!1,reviewNotifications:!1})]);case 3:o.sent(),o.label=4;case 4:return[2]}}))}))},e.prototype.processMessages=function(e){return r(this,void 0,void 0,(function(){var t,n,r,s,u,a,c;return o(this,(function(o){switch(o.label){case 0:return t=e.text.split(" "),n=t[0],t.slice(1),e.text&&"string"==typeof e.text?[4,(new l.default).getProfile(e.user)]:[3,5];case 1:return"string"==typeof(r=o.sent())?[3,3]:[4,this.addUserIfNotExist(e.channel,r.email)];case 2:o.sent(),o.label=3;case 3:return[4,this.services.userService.list({filter:{channelId:e.channel}})];case 4:0!==(s=o.sent()).length&&(u=e.text.match(/\"([^\"]+)\"/g)||[],a=u.map((function(e){return e.replace(/"/g,"")})),(c=this.ee).emit.apply(c,i([n,e.channel,s[0].stashDisplayName],a))),o.label=5;case 5:return[2]}}))}))},e.prototype.start=function(){this.ee.on(p.commands.HI,this.postMsgWithGreeting.bind(this)),this.ee.on(p.commands.ADD_DEVELOPER,this.postMsgWithDeveloperAdditionResult.bind(this)),this.ee.on(p.commands.ADD_REPOSITORY,this.postMsgWithRepositoryAdditionResult.bind(this)),this.ee.on(p.commands.DEVELOPERS,this.postMsgWithDevelopersList.bind(this)),this.ee.on(p.commands.REPOSITORIES,this.postMsgWithRepositoryList.bind(this)),this.ee.on(p.commands.SIGNUP,this.postMsgWithAuthLink.bind(this)),this.ee.on(p.commands.SUBSCRIBES,this.postMsgWithSubscribesList.bind(this)),this.ee.on(p.commands.SUBSCRIBE,this.postMsgWithSubscribeAdditionResult.bind(this)),this.ee.on(p.commands.UNSUBSCRIBE,this.postMsgWithSubscribeRemoveResult.bind(this)),this.ee.on(p.commands.HELP,this.postMsgWithCommands.bind(this)),this.rtm.on("message",this.processMessages.bind(this)),this.rtm.start()},e}();t.default=y},function(e,t){e.exports=require("@slack/rtm-api")},function(e,t){e.exports=require("events")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n){var r=t?"Hi, "+n+"!":"Hi! I'm *StashBot*";return e.buildDivider().buildSection(r).buildSection("I can notify you about new pull requests according to your subscriptions and pull requests where you was mentioned in comments or selected as reviewer"),t||e.buildSection("To do that could you please tell me your *name in stash* (for instance *I'm Sergey Popov*)"),e.buildSection("To see whole list of commands you should write *help*"),e.getMessage()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){return e.buildSection(t),e.getMessage()}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(2)),c=n(4),l=u(n(5)),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.postAddUserResult=function(e,t){return i(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return[4,this.services.userService.add(e.body)];case 1:return n=o.sent(),r="string"==typeof n?404:200,t.status(r).send(n),[2]}}))}))},t.prototype.makeRouter=function(){return this.router.post(l.default.API_USERS,c.userAuth,this.postAddUserResult.bind(this)),this.router},t}(a.default);t.default=f},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(2)),l=a(n(9)),f=n(1).PUBLIC,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.postIndex=function(e,t){return i(this,void 0,void 0,(function(){return s(this,(function(e){return console.log(f),t.sendFile(l.resolve(f,"index.html")),[2]}))}))},t.prototype.makeRouter=function(){return this.router.get("*",this.postIndex.bind(this)),this.router},t}(c.default);t.default=p}]);